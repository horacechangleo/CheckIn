<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>回報統計</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="keywords" content="Permaculture">
        <script src='js/jquery-3.4.1.min.js'></script>
        <script src='js/jquery-ui.js'></script>
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/base.css">
        <link rel="stylesheet" href="css/jquery-ui.css">
	</head>
	<body>
        <form>
            第
            <select name="Class" id="class">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>        
            </select>
            班
        </form>
        <p>日期：<input type="text" id="datepicker"></p>
        <div>時間：
            <div>
                <input type="radio" name="time" value="19:00">19:00<br>
                <input type="radio" name="time" value=""><input type="text" name="other_reason" />
            </div>            
        </div>
        <input type="button" value="送出" onclick="GetData()">
        
        <div id="text"></div>
        <input id="copy" type="button" value="複製" onclick="Copy()" style="display:none">
    </body>
    
    <script>
        $( "#datepicker" ).datepicker();

        function GetData() {
            var date = $("#datepicker").val().split('/');
            date = date[2] + '/' + date[0] + '/' + date[1];
            var data = {
                    "class": $("#class").val(),
                    "time": $("[name='time']:checked").val(),
                    "date": date
                }
            $.ajax({
                type: "GET",
                data: data,
                url: "https://script.google.com/macros/s/AKfycbzddq0vinssM0l0UC1vIk69b2lT4Q0xa8tCl0L9pnouiraD-eA/exec",
                success: function (e) {                    
                    $("#text").html(e);
                    $("#copy").css("display", "block");
                }
            });
        }
        function Copy() {
            var TextRange = document.createRange();
            TextRange.selectNode(document.getElementById("text"));
            sel = window.getSelection();
                sel.removeAllRanges();
                sel.addRange(TextRange);
            document.execCommand("copy");
            alert("複製完成！");
        }

    </script>
</html>